{"version":3,"mappings":"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","names":["messages","I18n","savedLanguage","language","key","newLanguage","lang","date","locale","i18n","t","KIOSK_CONFIG","stored","AVAILABLE_HOSPITALS","setHospital","hospitalId","hospital","h","URGENCY_CONFIG","ENCRYPTION_CONFIG","CONSTANTS","getRiskColor","percent","getRelevantTimestamp","caseData","getTimeAgo","timestamp","now","isoStr","then","seconds","minutes","formatETA","duration","eta","isGPSStale","lastUpdated","thresholdMinutes","lastUpdate","isCaseStale","created","validateCaseData","createTimeoutSignal","timeoutMs","controller","timeoutId","sleep","ms","resolve","ALGORITHM","KEY_LENGTH","IV_LENGTH","TAG_LENGTH","CryptoService","secretKey","keyBytes","c","error","plaintext","iv","encodedData","ciphertext","ctWithTag","tagStart","ct","tag","encryptedObj","decrypted","obj","fieldsToEncrypt","result","encryptedFieldNames","field","fields","encryptedField","payload","moduleType","response","buffer","base64","cryptoService","CaseListener","onUpdateCallback","onErrorCallback","lastError","attempt","url","data","delayMs","params","queryString","newCases","oldCaseIds","newCaseIds","decryptedCase","decryptError","caseId","isNew","gpsStale","enrichedTracking","ichPercent","caseListener","renderDashboard","cases","container","sortedCases","sortCases","cardsHTML","renderCaseCard","truncatedWarning","a","b","urgencyA","urgencyB","etaA","etaB","generatePatientCode","hash","i","urgencyConfig","lvoPercent","formattedETA","distance","isGpsStale","relevantTimestamp","receivedAgo","patientCode","ariaLabel","getModuleBadgeClass","type","renderRiskRingSVG","label","color","circumference","offset","ERROR_SEVERITY","ERROR_CATEGORIES","MedicalError","message","code","category","severity","context","GlobalErrorHandler","event","errorEntry","alert","globalErrorHandler","safeAsync","asyncFn","options","fallback","timeout","retries","timeoutPromise","_","reject","currentCases","audioContext","clockIntervalId","isFirstLoad","initializeKiosk","initializeHospitalSelector","initializeTheme","updateClock","initializeAudio","handleCaseUpdate","handleError","attachEventListeners","cleanup","initializeLanguage","savedLang","languageToggle","renderUKFlag","renderGermanyFlag","toggleLanguage","updateLanguage","updateButtonAttributes","id","btn","updateElementText","currentLang","selector","text","el","err","previousCount","updateHeader","playNewCaseAlert","flashScreen","updateConnectionStatus","__vitePreload","config","currentHospitalId","hospitals","e","savedTheme","applyTheme","themeToggle","toggleTheme","newTheme","theme","html","themeIcon","countBadge","count","connected","status","clockElement","oscillator","gainNode","caseCard","pwaUrl","dismissButton","handleDismissCase","closeModal","confirmMessage","modal"],"ignoreList":[],"sources":["../../localization/messages.js","../../localization/i18n.js","../../src/config.js","../../src/utils.js","../../src/services/crypto-service.js","../../src/services/case-listener.js","../../src/ui/dashboard.js","../../src/utils/error-handler.js","../../src/main.js"],"sourcesContent":["// Localization messages for the Stroke Triage Assistant\n\nexport const messages = {\n  en: {\n    incomingCase: \"Incoming Cases\",\n    noActiveCases: \"No Active Cases\",\n    activeSystemMessage: \"System is active and monitoring incoming cases\"\n  },\n\n  de: {\n    incomingCase: \"Eingehende FÃ¤lle\",\n    noActiveCases: \"Keine aktiven FÃ¤lle\",\n    activeSystemMessage: \"Das System ist aktiv und Ã¼berwacht eingehende FÃ¤lle\"\n  }\n};\n","// Internationalization utilities for the Stroke Triage Assistant\n\nimport { messages } from \"./messages.js\";\n\nclass I18n {\n  constructor() {\n    this.supportedLanguages = [\"en\", \"de\"];\n    this.currentLanguage = this.detectLanguage();\n  }\n\n  // Detect browser language and default to appropriate language\n  detectLanguage() {\n    // Check if language is already set in localStorage\n    const savedLanguage = localStorage.getItem(\"language\");\n    if (savedLanguage && this.supportedLanguages.includes(savedLanguage)) {\n      return savedLanguage;\n    }\n\n    // Detect browser language\n    const browserLang = navigator.language || navigator.userLanguage;\n    const langCode = browserLang.substring(0, 2).toLowerCase();\n\n    // Default to German if browser language is German, otherwise English\n    return langCode === \"de\" ? \"de\" : \"en\";\n  }\n\n  // Get current language\n  getCurrentLanguage() {\n    return this.currentLanguage;\n  }\n\n  // Set language and save to localStorage\n  setLanguage(language) {\n    if (this.supportedLanguages.includes(language)) {\n      this.currentLanguage = language;\n      localStorage.setItem(\"language\", language);\n\n      // Dispatch custom event for language change\n      window.dispatchEvent(\n        new CustomEvent(\"languageChanged\", {\n          detail: { language }\n        })\n      );\n\n      return true;\n    }\n    return false;\n  }\n\n  // Get supported languages\n  getSupportedLanguages() {\n    return [...this.supportedLanguages];\n  }\n\n  // Translate a message key\n  t(key) {\n    const currentMessages = messages[this.currentLanguage] || messages.en;\n    return currentMessages[key] || key;\n  }\n\n  // Toggle between English and German\n  toggleLanguage() {\n    const newLanguage = this.currentLanguage === \"en\" ? \"de\" : \"en\";\n    return this.setLanguage(newLanguage);\n  }\n\n  // Get language display name\n  getLanguageDisplayName(lang = null) {\n    const language = lang || this.currentLanguage;\n    const displayNames = {\n      en: \"English\",\n      de: \"Deutsch\"\n    };\n    return displayNames[language] || language;\n  }\n\n  // Format date/time according to current locale\n  formatDateTime(date) {\n    const locale = this.currentLanguage === \"de\" ? \"de-DE\" : \"en-US\";\n    return new Intl.DateTimeFormat(locale, {\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      second: \"2-digit\"\n    }).format(date);\n  }\n\n  // Format time only according to current locale\n  formatTime(date) {\n    const locale = this.currentLanguage === \"de\" ? \"de-DE\" : \"en-US\";\n    return new Intl.DateTimeFormat(locale, {\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      second: \"2-digit\"\n    }).format(date);\n  }\n}\n\n// Create singleton instance\nconst i18n = new I18n();\n\n// Export both the instance and the class\nexport { i18n, I18n };\n\n// Export convenience function for translation\nexport const t = (key) => i18n.t(key);\n","/**\n * Kiosk Configuration\n */\n\n// Check if running in development\nconst isDevelopment = import.meta.env.DEV;\n\nexport const KIOSK_CONFIG = {\n  // API Configuration\n  caseSharingUrl: \"https://case-sharing-564499947017.europe-west3.run.app\",\n\n  // PWA URL - use localhost in development\n  pwaUrl: isDevelopment\n    ? \"http://localhost:5173/0925/\"\n    : \"https://igfap.eu/0925/\",\n\n  // Polling interval (milliseconds)\n  pollInterval: 5000, // 5 seconds\n\n  // Auto-archive time (matches server)\n  autoArchiveHours: 2,\n\n  // GPS stale warning threshold\n  staleGpsMinutes: 5,\n\n  // Hospital ID (can be changed via UI selector)\n  // Leave as null to show all cases, or set to specific hospital ID\n  hospitalId: (() => {\n    const stored = localStorage.getItem(\"kiosk_hospital_id\");\n    // Explicitly check for null (not set) vs empty string (ALL selected)\n    if (stored === null) return null; // Default on first load\n    if (stored === \"\") return null; // \"ALL\" hospitals\n    return stored; // Specific hospital\n  })(),\n\n  // Hospital name for display (updated dynamically)\n  hospitalName:\n    localStorage.getItem(\"kiosk_hospital_name\") ||\n    \"LMU Klinikum MÃ¼nchen - GroÃŸhadern\",\n\n  // Google Maps API Key - set via VITE_GOOGLE_MAPS_KEY environment variable\n  // SECURITY: Never hardcode API keys in production\n  // eslint-disable-next-line no-undef\n  googleMapsApiKey: (() => {\n    try {\n      // eslint-disable-next-line no-undef\n      if (typeof __VITE_GOOGLE_MAPS_KEY__ !== \"undefined\" && __VITE_GOOGLE_MAPS_KEY__) {\n        // eslint-disable-next-line no-undef\n        return __VITE_GOOGLE_MAPS_KEY__;\n      }\n    } catch {\n      // Not defined at build time\n    }\n    // Development fallback - will be removed when env var is set\n    return isDevelopment ? \"AIzaSyACBndIj8HD1wwZ4Vw8PDDI0bIe6DoBExI\" : \"\";\n  })(),\n\n  // Alert settings\n  playAudioAlert: true,\n  audioAlertVolume: 0.5, // 0.0 to 1.0\n\n  // Display settings\n  showArchivedCases: false, // Hide archived cases\n  maxCasesDisplay: 20, // Maximum cases to show\n\n  // Theme\n  theme: \"dark\" // 'dark' or 'light'\n};\n\n// Available hospitals for selector\nexport const AVAILABLE_HOSPITALS = [\n  { id: \"BY-NS-001\", name: \"LMU Klinikum MÃ¼nchen - GroÃŸhadern\" },\n  { id: \"BY-NS-002\", name: \"Klinikum Rechts der Isar\" },\n  { id: \"BY-NS-003\", name: \"Helios Klinikum MÃ¼nchen West\" },\n  { id: \"BY-NS-004\", name: \"Klinikum Bogenhausen\" },\n  { id: \"BW-NS-001\", name: \"UniversitÃ¤tsklinikum TÃ¼bingen\" },\n  { id: \"BW-NS-005\", name: \"Klinikum Stuttgart - Katharinenhospital\" },\n  { id: \"BW-NS-003\", name: \"UniversitÃ¤tsklinikum Freiburg\" },\n  { id: \"ALL\", name: \"ðŸŒ All Hospitals (Show All Cases)\" }\n];\n\n// Function to update hospital selection\nexport function setHospital(hospitalId) {\n  const hospital = AVAILABLE_HOSPITALS.find((h) => h.id === hospitalId);\n  if (hospital) {\n    // Store the actual value or empty string for \"ALL\"\n    if (hospitalId === \"ALL\") {\n      localStorage.setItem(\"kiosk_hospital_id\", \"\");\n      localStorage.setItem(\"kiosk_hospital_name\", hospital.name);\n    } else {\n      localStorage.setItem(\"kiosk_hospital_id\", hospitalId);\n      localStorage.setItem(\"kiosk_hospital_name\", hospital.name);\n    }\n    KIOSK_CONFIG.hospitalId = hospitalId === \"ALL\" ? null : hospitalId;\n    KIOSK_CONFIG.hospitalName = hospital.name;\n    // Reload to apply changes\n    window.location.reload();\n  }\n}\n\nexport const URGENCY_CONFIG = {\n  IMMEDIATE: {\n    color: \"#ff4444\",\n    icon: \"ðŸš¨\",\n    priority: 0\n  },\n  TIME_CRITICAL: {\n    color: \"#ff8800\",\n    icon: \"â°\",\n    priority: 1\n  },\n  URGENT: {\n    color: \"#ffcc00\",\n    icon: \"âš ï¸\",\n    priority: 2\n  },\n  STANDARD: {\n    color: \"#4a90e2\",\n    icon: \"ðŸ¥\",\n    priority: 3\n  }\n};\n\n// End-to-end encryption configuration\n// Must match PWA encryption key for decryption to work\nexport const ENCRYPTION_CONFIG = {\n  // Encryption key - set via environment variable VITE_ENCRYPTION_KEY\n  encryptionKey: (() => {\n    try {\n      // Check for Vite build-time replacement\n      // eslint-disable-next-line no-undef\n      if (typeof __VITE_ENCRYPTION_KEY__ !== \"undefined\" && __VITE_ENCRYPTION_KEY__) {\n        // eslint-disable-next-line no-undef\n        return __VITE_ENCRYPTION_KEY__;\n      }\n    } catch {\n      // Not defined at build time\n    }\n    // Default key for development/testing only\n    // IMPORTANT: Must match PWA encryption key\n    return isDevelopment ? \"ha3RPfE+phgxyM6xAble98djW4dDdjnvMCIwv/KzSyA=\" : null;\n  })(),\n\n  // Enable/disable encryption\n  enabled: true,\n};\n","/**\n * Shared Utility Functions\n */\n\n// Constants for magic numbers\nexport const CONSTANTS = {\n  NEW_CASE_VIEWED_DELAY_MS: 2000,\n  ALERT_BEEP_DURATION_SEC: 0.5,\n  ALERT_BEEP_FREQUENCY_HZ: 880, // A5 note\n  ALERT_BEEP_VOLUME: 0.5,\n  FETCH_TIMEOUT_MS: 8000,\n  MAX_RETRY_ATTEMPTS: 3,\n  RETRY_DELAYS_MS: [2000, 4000, 8000], // Exponential backoff\n  CASE_STALE_THRESHOLD_MINUTES: 30\n};\n\n/**\n * Get risk color based on percentage\n * @param {number} percent - Risk percentage (0-100)\n * @returns {string} Hex color code\n */\nexport function getRiskColor(percent) {\n  if (percent > 70) {\n    return \"#ff4444\";\n  }\n  if (percent > 50) {\n    return \"#ff8800\";\n  }\n  if (percent > 30) {\n    return \"#ffcc00\";\n  }\n  return \"#4a90e2\";\n}\n\n/**\n * Get risk level label based on percentage\n * @param {number} percent - Risk percentage (0-100)\n * @returns {string} Risk level description\n */\nexport function getRiskLevel(percent) {\n  if (percent > 70) {\n    return \"Very High Risk\";\n  }\n  if (percent > 50) {\n    return \"High Risk\";\n  }\n  if (percent > 30) {\n    return \"Moderate Risk\";\n  }\n  return \"Low Risk\";\n}\n\n/**\n * Format timestamp as time string\n * @param {string} isoString - ISO date string\n * @returns {string} Formatted time (HH:MM)\n */\nexport function formatTime(isoString) {\n  try {\n    const date = new Date(isoString);\n    if (isNaN(date.getTime())) {\n      throw new Error(\"Invalid date\");\n    }\n    return date.toLocaleTimeString(\"de-DE\", {\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    });\n  } catch (error) {\n    console.warn(\"[Utils] Invalid time:\", isoString, error);\n    return \"Invalid time\";\n  }\n}\n\n/**\n * Get the most relevant timestamp for display\n * Priority: updatedAt > receivedAt > tracking.lastUpdated > createdAt\n * @param {object} caseData - Case data object\n * @returns {string|Date} Timestamp (ISO string or Date object)\n */\nexport function getRelevantTimestamp(caseData) {\n  // Priority 1: updatedAt (when case was last modified/submitted)\n  if (caseData.updatedAt) {\n    return caseData.updatedAt;\n  }\n\n  // Priority 2: receivedAt (when kiosk first saw this case - most reliable)\n  // This is our local timestamp and most accurate for \"when did we see this\"\n  if (caseData.lastUpdated) {\n    return caseData.lastUpdated;\n  }\n\n  // Priority 3: tracking.lastUpdated (recent GPS update)\n  if (caseData.tracking?.lastUpdated) {\n    return caseData.tracking.lastUpdated;\n  }\n\n  // Priority 4: createdAt (fallback - may be hours old if form was started earlier)\n  return caseData.createdAt || new Date();\n}\n\n/**\n * Get time ago string with negative time protection\n * @param {string|Date} timestamp - ISO date string or Date object\n * @returns {string} Time ago description\n */\nexport function getTimeAgo(timestamp) {\n  const now = new Date();\n\n  // Handle both Date objects and ISO strings\n  // Treat timestamps without timezone info as UTC (server runs in UTC)\n  let isoStr = timestamp instanceof Date ? timestamp.toISOString() : String(timestamp);\n  if (typeof timestamp === 'string' && !/Z$/.test(isoStr) && !/[+-]\\d{2}:\\d{2}$/.test(isoStr)) {\n    isoStr += 'Z';\n  }\n  const then = new Date(isoStr);\n\n  // Protect against invalid dates or future dates\n  if (isNaN(then.getTime())) {\n    return \"Unknown\";\n  }\n\n  const seconds = Math.max(0, Math.floor((now - then) / 1000));\n\n  if (seconds < 60) {\n    return `${seconds}s ago`;\n  }\n  const minutes = Math.floor(seconds / 60);\n  if (minutes < 60) {\n    return `${minutes}m ago`;\n  }\n  const hours = Math.floor(minutes / 60);\n  return `${hours}h ${minutes % 60}m ago`;\n}\n\n/**\n * Format label from snake_case to Title Case\n * @param {string} key - Key to format\n * @returns {string} Formatted label\n */\nexport function formatLabel(key) {\n  return key.replace(/_/g, \" \").replace(/\\b\\w/g, (l) => l.toUpperCase());\n}\n\n/**\n * Format ETA with special cases\n * @param {number|string} duration - Duration in minutes\n * @returns {string} Formatted ETA\n */\nexport function formatETA(duration) {\n  if (duration === null || duration === undefined || duration === \"?\") {\n    return \"?\";\n  }\n\n  const eta = typeof duration === \"string\" ? parseFloat(duration) : duration;\n\n  if (isNaN(eta)) {\n    return \"?\";\n  }\n\n  if (eta <= 0) {\n    return \"Arrived\";\n  }\n\n  if (eta < 1) {\n    return \"< 1\";\n  }\n\n  return Math.round(eta).toString();\n}\n\n/**\n * Check if GPS data is stale\n * @param {string} lastUpdated - ISO date string of last GPS update\n * @param {number} thresholdMinutes - Staleness threshold in minutes\n * @returns {boolean} True if GPS is stale\n */\nexport function isGPSStale(lastUpdated, thresholdMinutes = 5) {\n  if (!lastUpdated) {\n    return true;\n  }\n\n  try {\n    const lastUpdate = new Date(lastUpdated);\n    if (isNaN(lastUpdate.getTime())) {\n      return true;\n    }\n\n    const now = new Date();\n    const minutesAgo = (now - lastUpdate) / (1000 * 60);\n    return minutesAgo > thresholdMinutes;\n  } catch {\n    return true;\n  }\n}\n\n/**\n * Check if case is stale (old)\n * @param {string|Date} timestamp - ISO date string or Date object\n * @param {number} thresholdMinutes - Staleness threshold in minutes\n * @returns {boolean} True if case is stale\n */\nexport function isCaseStale(\n  timestamp,\n  thresholdMinutes = CONSTANTS.CASE_STALE_THRESHOLD_MINUTES\n) {\n  if (!timestamp) {\n    return false;\n  }\n\n  try {\n    // Handle both Date objects and ISO strings\n    const created = timestamp instanceof Date ? timestamp : new Date(timestamp);\n    if (isNaN(created.getTime())) {\n      return false;\n    }\n\n    const now = new Date();\n    const minutesAgo = (now - created) / (1000 * 60);\n    return minutesAgo > thresholdMinutes;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Validate case data structure\n * @param {object} caseData - Case object to validate\n * @returns {boolean} True if valid\n */\nexport function validateCaseData(caseData) {\n  if (!caseData || typeof caseData !== \"object\") {\n    return false;\n  }\n\n  // Required fields\n  if (!caseData.id || typeof caseData.id !== \"string\") {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Safe get nested property\n * @param {object} obj - Object to query\n * @param {string} path - Dot-separated path (e.g., 'results.ich.probability')\n * @param {*} defaultValue - Default value if not found\n * @returns {*} Value or default\n */\nexport function safeGet(obj, path, defaultValue = null) {\n  try {\n    return (\n      path.split(\".\").reduce((current, prop) => current?.[prop], obj) ??\n      defaultValue\n    );\n  } catch {\n    return defaultValue;\n  }\n}\n\n/**\n * Create AbortSignal with timeout (polyfill for older browsers)\n * @param {number} timeoutMs - Timeout in milliseconds\n * @returns {AbortSignal} Abort signal that fires after timeout\n */\nexport function createTimeoutSignal(timeoutMs) {\n  // Use native AbortSignal.timeout if available (modern browsers)\n  if (typeof AbortSignal !== \"undefined\" && AbortSignal.timeout) {\n    return AbortSignal.timeout(timeoutMs);\n  }\n\n  // Polyfill for older browsers\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => {\n    controller.abort(new Error(`Timeout after ${timeoutMs}ms`));\n  }, timeoutMs);\n\n  // Clean up timeout if signal is aborted for other reasons\n  controller.signal.addEventListener(\n    \"abort\",\n    () => {\n      clearTimeout(timeoutId);\n    },\n    { once: true }\n  );\n\n  return controller.signal;\n}\n\n/**\n * Sleep utility for retry logic\n * @param {number} ms - Milliseconds to sleep\n * @returns {Promise} Promise that resolves after delay\n */\nexport function sleep(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n/**\n * Medical field label mapping for consistent terminology\n * Maps technical field names to user-friendly medical labels\n */\nconst FIELD_LABEL_MAP = {\n  // Age and demographics\n  age_years: \"Alter / Age\",\n  age: \"Alter / Age\",\n\n  // Blood pressure\n  systolic_bp: \"Systolischer Blutdruck / Systolic BP\",\n  diastolic_bp: \"Diastolischer Blutdruck / Diastolic BP\",\n  systolic_blood_pressure: \"Systolischer Blutdruck / Systolic BP\",\n  diastolic_blood_pressure: \"Diastolischer Blutdruck / Diastolic BP\",\n  blood_pressure_systolic: \"Systolischer Blutdruck / Systolic BP\",\n  blood_pressure_diastolic: \"Diastolischer Blutdruck / Diastolic BP\",\n\n  // Biomarkers\n  gfap_value: \"GFAP-Wert / GFAP Level\",\n  gfap: \"GFAP-Wert / GFAP Level\",\n  gfap_level: \"GFAP-Wert / GFAP Level\",\n\n  // Clinical scores\n  fast_ed_score: \"FAST-ED Score\",\n  fast_ed: \"FAST-ED Score\",\n  fast_ed_total: \"FAST-ED Score\",\n  nihss: \"NIHSS Score\",\n  nihss_score: \"NIHSS Score\",\n\n  // Neurological symptoms\n  vigilanzminderung: \"Vigilanzminderung / Reduced Consciousness\",\n  vigilance_reduction: \"Vigilanzminderung / Reduced Consciousness\",\n  reduced_consciousness: \"Vigilanzminderung / Reduced Consciousness\",\n  armparese: \"Armparese / Arm Weakness\",\n  arm_paresis: \"Armparese / Arm Weakness\",\n  arm_weakness: \"Armparese / Arm Weakness\",\n  beinparese: \"Beinparese / Leg Weakness\",\n  leg_paresis: \"Beinparese / Leg Weakness\",\n  leg_weakness: \"Beinparese / Leg Weakness\",\n  eye_deviation: \"Blickdeviation / Eye Deviation\",\n  blickdeviation: \"Blickdeviation / Eye Deviation\",\n  headache: \"Kopfschmerzen / Headache\",\n  kopfschmerzen: \"Kopfschmerzen / Headache\",\n  nausea: \"Ãœbelkeit / Nausea\",\n  vomiting: \"Erbrechen / Vomiting\",\n  aphasia: \"Aphasie / Aphasia\",\n  dysarthria: \"Dysarthrie / Dysarthria\",\n  ataxia: \"Ataxie / Ataxia\",\n  facial_paresis: \"Gesichtsparese / Facial Weakness\",\n\n  // Medical history\n  atrial_fibrillation: \"Vorhofflimmern / Atrial Fibrillation\",\n  vorhofflimmern: \"Vorhofflimmern / Atrial Fibrillation\",\n  anticoagulated_noak: \"Antikoagulation (NOAK) / Anticoagulation (NOAC)\",\n  anticoagulation: \"Antikoagulation / Anticoagulation\",\n  antiplatelets: \"Thrombozytenaggregationshemmer / Antiplatelets\",\n  thrombozytenaggregationshemmer:\n    \"Thrombozytenaggregationshemmer / Antiplatelets\",\n  diabetes: \"Diabetes Mellitus\",\n  hypertension: \"Arterielle Hypertonie / Hypertension\",\n  prior_stroke: \"Schlaganfall (Anamnese) / Prior Stroke\",\n  prior_tia: \"TIA (Anamnese) / Prior TIA\",\n\n  // Timing\n  symptom_onset: \"Symptombeginn / Symptom Onset\",\n  onset_time: \"Symptombeginn / Symptom Onset\",\n  time_since_onset: \"Zeit seit Symptombeginn / Time Since Onset\"\n};\n\n/**\n * Pattern-based replacements for common medical terms\n */\nconst PATTERN_REPLACEMENTS = [\n  { pattern: /_score$/i, replacement: \" Score\" },\n  { pattern: /_value$/i, replacement: \" Wert\" },\n  { pattern: /_bp$/i, replacement: \" Blutdruck\" },\n  { pattern: /_years?$/i, replacement: \"\" },\n  { pattern: /^ich_/i, replacement: \"ICH \" },\n  { pattern: /^lvo_/i, replacement: \"LVO \" },\n  { pattern: /parese$/i, replacement: \"parese / Weakness\" },\n  { pattern: /deviation$/i, replacement: \"deviation / Deviation\" }\n];\n\n/**\n * Format driver/field names with consistent medical terminology\n * @param {string} fieldName - Technical field name\n * @returns {string} User-friendly medical label\n */\nexport function formatDriverName(fieldName) {\n  if (!fieldName) return \"\";\n\n  // First try exact match\n  const mapped = FIELD_LABEL_MAP[fieldName.toLowerCase()];\n  if (mapped) return mapped;\n\n  // Apply pattern-based replacements\n  let formatted = fieldName;\n  PATTERN_REPLACEMENTS.forEach(({ pattern, replacement }) => {\n    formatted = formatted.replace(pattern, replacement);\n  });\n\n  // Clean up and format\n  formatted = formatted\n    .replace(/_/g, \" \") // Replace underscores with spaces\n    .replace(/\\b\\w/g, (l) => l.toUpperCase()) // Title case\n    .trim();\n\n  return formatted;\n}\n\n/**\n * Format field labels for summary display\n * @param {string} fieldName - Technical field name\n * @returns {string} User-friendly summary label\n */\nexport function formatSummaryLabel(fieldName) {\n  const friendlyLabel = formatDriverName(fieldName);\n  // Remove units from labels as they're shown in values\n  return friendlyLabel.replace(/\\s*\\([^)]*\\)\\s*/g, \"\").trim();\n}\n\n/**\n * Format field values for display with appropriate units\n * @param {any} value - Field value\n * @param {string} fieldName - Field name for context\n * @returns {string} Formatted display value\n */\nexport function formatDisplayValue(value, fieldName = \"\") {\n  if (value === null || value === undefined || value === \"\") {\n    return \"â€”\";\n  }\n\n  if (typeof value === \"boolean\") {\n    return value ? \"âœ“ Ja / Yes\" : \"âœ— Nein / No\";\n  }\n\n  if (typeof value === \"number\") {\n    const lower = fieldName.toLowerCase();\n    // Add units based on field type\n    if (lower.includes(\"bp\") || lower.includes(\"blood_pressure\")) {\n      return `${value} mmHg`;\n    }\n    if (lower.includes(\"gfap\")) {\n      return `${value} pg/mL`;\n    }\n    if (lower.includes(\"age\")) {\n      return `${value} Jahre / years`;\n    }\n    if (lower.includes(\"score\")) {\n      return value.toString();\n    }\n    if (lower.includes(\"time\") || lower.includes(\"duration\")) {\n      return `${value} min`;\n    }\n\n    // Default number formatting\n    return Number.isInteger(value) ? value.toString() : value.toFixed(1);\n  }\n\n  return value.toString();\n}\n","/**\n * iGFAP Encryption Service\n * AES-256-GCM encryption for patient data protection\n *\n * Provides end-to-end encryption between PWA, Cloud Functions, and Kiosk.\n * Google Cloud infrastructure cannot decrypt the data (no key access).\n */\n\nconst ALGORITHM = \"AES-GCM\";\nconst KEY_LENGTH = 256;\nconst IV_LENGTH = 12;\nconst TAG_LENGTH = 128;\n\nclass CryptoService {\n  constructor() {\n    this.key = null;\n    this.initialized = false;\n  }\n\n  /**\n   * Initialize the crypto service with the shared secret\n   * @param {string} secretKey - Base64 encoded 32-byte AES key\n   */\n  async init(secretKey) {\n    if (!secretKey) {\n      console.warn(\"[CryptoService] No encryption key provided - encryption disabled\");\n      return;\n    }\n\n    try {\n      // Base64-decode the key (should be exactly 32 bytes for AES-256)\n      const keyBytes = Uint8Array.from(atob(secretKey), c => c.charCodeAt(0));\n\n      if (keyBytes.length !== 32) {\n        throw new Error(`Invalid key length: ${keyBytes.length} bytes (expected 32)`);\n      }\n\n      // Import the decoded key directly as AES-GCM key\n      this.key = await crypto.subtle.importKey(\n        \"raw\",\n        keyBytes,\n        { name: ALGORITHM, length: KEY_LENGTH },\n        false,\n        [\"encrypt\", \"decrypt\"]\n      );\n\n      this.initialized = true;\n      console.log(\"[CryptoService] Initialized successfully (direct key import)\");\n    } catch (error) {\n      console.error(\"[CryptoService] Initialization failed:\", error);\n      this.initialized = false;\n    }\n  }\n\n  /**\n   * Check if encryption is available\n   * @returns {boolean}\n   */\n  isEnabled() {\n    return this.initialized && this.key !== null;\n  }\n\n  /**\n   * Encrypt data\n   * @param {any} plaintext - Data to encrypt (string or object)\n   * @returns {Promise<Object>} Encrypted payload with iv, ct, tag\n   */\n  async encrypt(plaintext) {\n    if (!this.initialized) {\n      throw new Error(\"CryptoService not initialized\");\n    }\n\n    const iv = crypto.getRandomValues(new Uint8Array(IV_LENGTH));\n    const encodedData = new TextEncoder().encode(\n      typeof plaintext === \"string\" ? plaintext : JSON.stringify(plaintext)\n    );\n\n    const ciphertext = await crypto.subtle.encrypt(\n      { name: ALGORITHM, iv, tagLength: TAG_LENGTH },\n      this.key,\n      encodedData\n    );\n\n    // GCM appends tag to ciphertext, extract it\n    const ctWithTag = new Uint8Array(ciphertext);\n    const tagStart = ctWithTag.length - (TAG_LENGTH / 8);\n    const ct = ctWithTag.slice(0, tagStart);\n    const tag = ctWithTag.slice(tagStart);\n\n    return {\n      v: 2,\n      alg: \"AES-256-GCM\",\n      iv: this._toBase64(iv),\n      ct: this._toBase64(ct),\n      tag: this._toBase64(tag)\n    };\n  }\n\n  /**\n   * Decrypt data\n   * @param {Object} encryptedObj - Encrypted payload with v, iv, ct, tag\n   * @returns {Promise<any>} Decrypted data\n   */\n  async decrypt(encryptedObj) {\n    if (!this.initialized) {\n      throw new Error(\"CryptoService not initialized\");\n    }\n\n    // Handle legacy unencrypted data\n    if (!encryptedObj || !encryptedObj.v || encryptedObj.v < 2) {\n      return encryptedObj;\n    }\n\n    try {\n      const iv = this._fromBase64(encryptedObj.iv);\n      const ct = this._fromBase64(encryptedObj.ct);\n      const tag = this._fromBase64(encryptedObj.tag);\n\n      // Reconstruct ciphertext with tag for GCM\n      const ctWithTag = new Uint8Array(ct.length + tag.length);\n      ctWithTag.set(ct);\n      ctWithTag.set(tag, ct.length);\n\n      const decrypted = await crypto.subtle.decrypt(\n        { name: ALGORITHM, iv, tagLength: TAG_LENGTH },\n        this.key,\n        ctWithTag\n      );\n\n      const plaintext = new TextDecoder().decode(decrypted);\n\n      try {\n        return JSON.parse(plaintext);\n      } catch {\n        return plaintext;\n      }\n    } catch (error) {\n      console.error(\"[CryptoService] Decryption failed:\", error);\n      throw new Error(\"Decryption failed - invalid key or corrupted data\");\n    }\n  }\n\n  /**\n   * Encrypt specific fields in an object, leaving others in cleartext\n   * @param {Object} obj - Object to partially encrypt\n   * @param {string[]} fieldsToEncrypt - Field names to encrypt\n   * @returns {Promise<Object>} Object with encrypted fields\n   */\n  async encryptFields(obj, fieldsToEncrypt) {\n    if (!this.initialized) {\n      console.warn(\"[CryptoService] Not initialized - returning unencrypted\");\n      return obj;\n    }\n\n    const result = { ...obj };\n    const encryptedFieldNames = [];\n\n    for (const field of fieldsToEncrypt) {\n      if (result[field] !== undefined) {\n        result[`_enc_${field}`] = await this.encrypt(result[field]);\n        delete result[field];\n        encryptedFieldNames.push(field);\n      }\n    }\n\n    if (encryptedFieldNames.length > 0) {\n      result._encrypted = true;\n      result._encFields = encryptedFieldNames;\n      result._encVersion = 2;\n    }\n\n    return result;\n  }\n\n  /**\n   * Decrypt specific fields in an object\n   * @param {Object} obj - Object with encrypted fields\n   * @returns {Promise<Object>} Object with decrypted fields\n   */\n  async decryptFields(obj) {\n    if (!obj || !obj._encrypted) {\n      return obj; // Not encrypted, return as-is\n    }\n\n    if (!this.initialized) {\n      console.error(\"[CryptoService] Cannot decrypt - not initialized\");\n      throw new Error(\"CryptoService not initialized\");\n    }\n\n    const result = { ...obj };\n    const fields = obj._encFields || [];\n\n    for (const field of fields) {\n      const encryptedField = `_enc_${field}`;\n      if (result[encryptedField]) {\n        try {\n          result[field] = await this.decrypt(result[encryptedField]);\n          delete result[encryptedField];\n        } catch (error) {\n          console.error(`[CryptoService] Failed to decrypt field ${field}:`, error);\n          // Keep encrypted version if decryption fails\n        }\n      }\n    }\n\n    delete result._encrypted;\n    delete result._encFields;\n    delete result._encVersion;\n\n    return result;\n  }\n\n  /**\n   * Encrypt an API request payload\n   * @param {Object} payload - Request payload\n   * @param {string} moduleType - Module type for routing (kept in cleartext)\n   * @returns {Promise<Object>} Encrypted request\n   */\n  async encryptRequest(payload, moduleType) {\n    if (!this.initialized) {\n      return payload; // Return unencrypted if not initialized\n    }\n\n    return {\n      encrypted: await this.encrypt(payload),\n      moduleType: moduleType, // Keep in cleartext for routing\n      _v: 2\n    };\n  }\n\n  /**\n   * Decrypt an API response\n   * @param {Object} response - Response from API\n   * @returns {Promise<Object>} Decrypted response\n   */\n  async decryptResponse(response) {\n    if (!response || !response.encrypted) {\n      return response; // Not encrypted\n    }\n\n    if (!this.initialized) {\n      throw new Error(\"Cannot decrypt response - CryptoService not initialized\");\n    }\n\n    return await this.decrypt(response.encrypted);\n  }\n\n  // Helper: Convert Uint8Array to Base64\n  _toBase64(buffer) {\n    return btoa(String.fromCharCode(...new Uint8Array(buffer)));\n  }\n\n  // Helper: Convert Base64 to Uint8Array\n  _fromBase64(base64) {\n    return Uint8Array.from(atob(base64), c => c.charCodeAt(0));\n  }\n}\n\n// Singleton instance\nexport const cryptoService = new CryptoService();\nexport default cryptoService;\n","/**\n * Case Listener Service\n * Polls Cloud Function for active cases\n * Supports end-to-end encryption for patient data protection\n */\nimport { KIOSK_CONFIG } from \"../config.js\";\nimport {\n  createTimeoutSignal,\n  sleep,\n  validateCaseData,\n  isGPSStale,\n  CONSTANTS\n} from \"../utils.js\";\nimport { cryptoService } from \"./crypto-service.js\";\n\nexport class CaseListener {\n  constructor() {\n    this.baseUrl = KIOSK_CONFIG.caseSharingUrl;\n    this.pollInterval = KIOSK_CONFIG.pollInterval;\n    // Don't cache hospitalId - always read from KIOSK_CONFIG for real-time updates\n    this.intervalId = null;\n    this.cases = new Map();\n    this.onUpdate = null;\n    this.onError = null;\n    this.lastFetchTime = null;\n    this.isConnected = false;\n    this.retryCount = 0;\n  }\n\n  /**\n   * Start listening for cases\n   * @param {Function} onUpdateCallback - Called when cases update\n   * @param {Function} onErrorCallback - Called on errors\n   */\n  start(onUpdateCallback, onErrorCallback) {\n    this.onUpdate = onUpdateCallback;\n    this.onError = onErrorCallback;\n\n    // Initial fetch\n    this.fetchCases();\n\n    // Start polling\n    this.intervalId = setInterval(() => {\n      this.fetchCases();\n    }, this.pollInterval);\n\n    console.log(\n      \"[CaseListener] Started polling every\",\n      this.pollInterval,\n      \"ms\"\n    );\n  }\n\n  /**\n   * Stop listening\n   */\n  stop() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n      console.log(\"[CaseListener] Stopped polling\");\n    }\n  }\n\n  /**\n   * Fetch cases from API with retry logic\n   */\n  async fetchCases() {\n    let lastError = null;\n\n    for (let attempt = 0; attempt <= CONSTANTS.MAX_RETRY_ATTEMPTS; attempt++) {\n      try {\n        const url = this.buildFetchUrl();\n\n        const response = await fetch(url, {\n          method: \"GET\",\n          headers: {\n            Accept: \"application/json\"\n          },\n          signal: createTimeoutSignal(CONSTANTS.FETCH_TIMEOUT_MS)\n        });\n\n        if (!response.ok) {\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n        }\n\n        const data = await response.json();\n\n        if (!data.success) {\n          throw new Error(data.error || \"Failed to fetch cases\");\n        }\n\n        // Success! Reset retry count and update connection status\n        this.retryCount = 0;\n        this.isConnected = true;\n        this.lastFetchTime = new Date();\n\n        // Process cases (may include decryption)\n        await this.processCases(data.cases || []);\n\n        // Notify listeners\n        if (this.onUpdate) {\n          this.onUpdate({\n            cases: Array.from(this.cases.values()),\n            timestamp: data.timestamp,\n            count: data.count\n          });\n        }\n\n        return; // Success, exit function\n      } catch (error) {\n        lastError = error;\n        console.error(\n          `[CaseListener] Fetch error (attempt ${attempt + 1}/${CONSTANTS.MAX_RETRY_ATTEMPTS + 1}):`,\n          error\n        );\n\n        // If not the last attempt, wait before retrying\n        if (attempt < CONSTANTS.MAX_RETRY_ATTEMPTS) {\n          const delayMs = CONSTANTS.RETRY_DELAYS_MS[attempt] || 8000;\n          console.log(`[CaseListener] Retrying in ${delayMs}ms...`);\n          await sleep(delayMs);\n        }\n      }\n    }\n\n    // All retries failed\n    console.error(\"[CaseListener] All retry attempts failed:\", lastError);\n    this.isConnected = false;\n    this.retryCount++;\n\n    if (this.onError) {\n      this.onError(lastError);\n    }\n  }\n\n  /**\n   * Build fetch URL with filters\n   */\n  buildFetchUrl() {\n    let url = `${this.baseUrl}/get-cases`;\n    const params = new URLSearchParams();\n\n    // Explicit handling (VERY IMPORTANT)\n    if (KIOSK_CONFIG.hospitalId && KIOSK_CONFIG.hospitalId !== \"ALL\") {\n      params.append(\"hospitalId\", KIOSK_CONFIG.hospitalId);\n    }\n\n    params.append(\"status\", \"pending\");\n\n    const queryString = params.toString();\n    if (queryString) {\n      url += `?${queryString}`;\n    }\n\n    return url;\n  }\n\n  /**\n   * Process fetched cases with validation and enrichment\n   * Decrypts encrypted fields if encryption is enabled\n   */\n  async processCases(newCases) {\n    const oldCaseIds = new Set(this.cases.keys());\n    const newCaseIds = new Set();\n\n    // Process each case\n    for (const caseData of newCases) {\n      // Decrypt encrypted fields if present\n      let decryptedCase = caseData;\n      if (cryptoService.isEnabled() && caseData._encrypted) {\n        try {\n          decryptedCase = await cryptoService.decryptFields(caseData);\n          console.log(\"[CaseListener] Case decrypted:\", caseData.id);\n        } catch (decryptError) {\n          console.error(\"[CaseListener] Decryption failed for case:\", caseData.id, decryptError);\n          // Skip this case if decryption fails\n          continue;\n        }\n      }\n\n      // Validate case data\n      if (!validateCaseData(decryptedCase)) {\n        console.warn(\"[CaseListener] Invalid case data, skipping:\", decryptedCase);\n        continue;\n      }\n\n      const caseId = decryptedCase.id;\n      newCaseIds.add(caseId);\n\n      const isNew = !this.cases.has(caseId);\n\n      // Calculate GPS staleness\n      const gpsStale = isGPSStale(\n        decryptedCase.tracking?.lastUpdated,\n        KIOSK_CONFIG.staleGpsMinutes\n      );\n\n      // Enrich tracking data\n      const enrichedTracking = {\n        ...(decryptedCase.tracking || {}),\n        gpsStale\n      };\n\n      // Store case with enriched data\n      this.cases.set(caseId, {\n        ...decryptedCase,\n        tracking: enrichedTracking,\n        isNew, // Flag for new case alert\n        receivedAt: isNew ? new Date() : this.cases.get(caseId).receivedAt\n      });\n\n      // Log new cases with timestamp info\n      if (isNew) {\n        console.log(\n          \"[CaseListener] New case:\",\n          caseId,\n          this.getCaseSummary(decryptedCase)\n        );\n        console.log(\"[CaseListener] Timestamps:\", {\n          createdAt: decryptedCase.createdAt,\n          updatedAt: decryptedCase.updatedAt,\n          receivedAt: decryptedCase.receivedAt,\n          trackingLastUpdated: decryptedCase.tracking?.lastUpdated\n        });\n      }\n    }\n\n    // Remove cases that are no longer active\n    oldCaseIds.forEach((caseId) => {\n      if (!newCaseIds.has(caseId)) {\n        console.log(\"[CaseListener] Case removed:\", caseId);\n        this.cases.delete(caseId);\n      }\n    });\n  }\n\n  /**\n   * Get case summary for logging\n   */\n  getCaseSummary(caseData) {\n    const ichPercent = Math.round(\n      (caseData.results?.ich?.probability || 0) * 100\n    );\n    const eta = caseData.tracking?.duration || \"?\";\n\n    return {\n      module: caseData.moduleType,\n      ich: `${ichPercent}%`,\n      eta: `${eta} min`,\n      urgency: caseData.urgency\n    };\n  }\n\n  /**\n   * Get all cases\n   */\n  getCases() {\n    return Array.from(this.cases.values());\n  }\n\n  /**\n   * Get case by ID\n   */\n  getCase(caseId) {\n    return this.cases.get(caseId);\n  }\n\n  /**\n   * Mark case as viewed (clear isNew flag)\n   */\n  markViewed(caseId) {\n    const caseData = this.cases.get(caseId);\n    if (caseData) {\n      caseData.isNew = false;\n      this.cases.set(caseId, caseData);\n    }\n  }\n\n  /**\n   * Dismiss/archive a case\n   * @param {string} caseId - Case ID to dismiss\n   * @returns {Promise} - Resolution of API call\n   */\n  async dismissCase(caseId) {\n    try {\n      const url = `${this.baseUrl}/archive-case`;\n\n      const response = await fetch(url, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\"\n        },\n        body: JSON.stringify({\n          caseId,\n          reason: \"dismissed_by_kiosk\"\n        }),\n        signal: AbortSignal.timeout(8000)\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n\n      if (!data.success) {\n        throw new Error(data.error || \"Failed to dismiss case\");\n      }\n\n      // Remove from local cache\n      this.cases.delete(caseId);\n      console.log(\"[CaseListener] Case dismissed:\", caseId);\n\n      // Trigger update to refresh UI\n      if (this.onUpdate) {\n        this.onUpdate({\n          cases: Array.from(this.cases.values()),\n          timestamp: new Date().toISOString(),\n          count: this.cases.size\n        });\n      }\n\n      return data;\n    } catch (error) {\n      console.error(\"[CaseListener] Dismiss error:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get connection status\n   */\n  getStatus() {\n    return {\n      isConnected: this.isConnected,\n      lastFetchTime: this.lastFetchTime,\n      caseCount: this.cases.size,\n      isPolling: this.intervalId !== null\n    };\n  }\n}\n\n// Export singleton\nexport const caseListener = new CaseListener();\n","/**\n * Dashboard UI - Tailwind Case List View\n */\nimport { t } from \"../../localization/i18n.js\";\nimport { URGENCY_CONFIG, KIOSK_CONFIG } from \"../config.js\";\nimport {\n  getRiskColor,\n  getTimeAgo,\n  formatETA,\n  isCaseStale,\n  getRelevantTimestamp\n} from \"../utils.js\";\n\nexport function renderDashboard(cases) {\n  const container = document.getElementById(\"casesContainer\");\n  if (!container) return;\n\n  // ðŸ©¶ Empty state\n  if (!cases || cases.length === 0) {\n    container.innerHTML = `\n      <div class=\"flex flex-col items-center justify-center text-center py-16 text-gray-500 dark:text-gray-300\">\n        <div class=\"text-6xl mb-4\">âœ“</div>\n        <h2 class=\"text-xl font-semibold mb-2\">${t(\"noActiveCases\")}</h2>\n        <p class=\"text-sm\">${t(\"activeSystemMessage\")}</p>\n      </div>\n    `;\n    return;\n  }\n\n  // Sort by urgency & ETA\n  const sortedCases = sortCases(cases);\n\n  // Apply display limit\n  const displayCases = sortedCases.slice(0, KIOSK_CONFIG.maxCasesDisplay);\n\n  // Generate card HTML\n  const cardsHTML = displayCases.map(renderCaseCard).join(\"\");\n\n  // Show truncation warning if applicable\n  const truncatedWarning =\n    sortedCases.length > KIOSK_CONFIG.maxCasesDisplay\n      ? `\n        <div class=\"text-center text-amber-600 dark:text-amber-400 text-sm mb-4\" role=\"alert\">\n          Showing ${KIOSK_CONFIG.maxCasesDisplay} of ${sortedCases.length} cases\n        </div>`\n      : \"\";\n\n  // ðŸ©µ Grid layout with responsive columns\n  container.innerHTML = `\n    ${truncatedWarning}\n    <div class=\"grid gap-6 px-6 sm:px-3 pb-8 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 bg-gray-50 dark:bg-gray-900 transition-colors duration-300\">\n      ${cardsHTML}\n    </div>\n  `;\n}\n\n/**\n * Sort cases by urgency priority & ETA\n */\nfunction sortCases(cases) {\n  return [...cases].sort((a, b) => {\n    const urgencyA = URGENCY_CONFIG[a.urgency]?.priority ?? 10;\n    const urgencyB = URGENCY_CONFIG[b.urgency]?.priority ?? 10;\n    if (urgencyA !== urgencyB) return urgencyA - urgencyB;\n    const etaA = a.tracking?.duration || 9999;\n    const etaB = b.tracking?.duration || 9999;\n    return etaA - etaB;\n  });\n}\n\n/**\n * Generate patient code from case ID\n */\nfunction generatePatientCode(caseId) {\n  if (!caseId) return \"PAT-0000\";\n  let hash = 0;\n  for (let i = 0; i < caseId.length; i++) {\n    hash = (hash << 5) - hash + caseId.charCodeAt(i);\n    hash |= 0;\n  }\n  const code = Math.abs(hash % 10000)\n    .toString()\n    .padStart(4, \"0\");\n  return `PAT-${code}`;\n}\n\n/**\n * Render individual case card (Tailwind)\n */\nfunction renderCaseCard(caseData) {\n  const urgencyConfig =\n    URGENCY_CONFIG[caseData.urgency] || URGENCY_CONFIG.STANDARD;\n  const ichPercent = Math.round(\n    (caseData.results?.ich?.probability || 0) * 100\n  );\n  const lvoPercent = caseData.results?.lvo\n    ? Math.round(caseData.results.lvo.probability * 100)\n    : null;\n  const formattedETA = formatETA(caseData.tracking?.duration);\n  const distance = caseData.tracking?.distance ?? \"?\";\n  const isGpsStale = caseData.tracking?.gpsStale || false;\n  const relevantTimestamp = getRelevantTimestamp(caseData);\n  const caseIsStale = isCaseStale(relevantTimestamp);\n  const receivedAgo = getTimeAgo(relevantTimestamp);\n  const patientCode = caseData.cityCode || generatePatientCode(caseData.id);\n\n  const ariaLabel = `${caseData.urgency} case, ${patientCode}, ICH risk ${ichPercent}%, ETA ${formattedETA} minutes`;\n\n  function getModuleBadgeClass(type) {\n    switch (type.toLowerCase()) {\n      case \"coma\":\n        return \"bg-blue-100 text-blue-700 dark:bg-blue-800 dark:text-blue-100\";\n      case \"full\":\n        return \"bg-purple-100 text-purple-700 dark:bg-purple-800 dark:text-purple-100\";\n      default:\n        return \"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-200\";\n    }\n  }\n  return `\n    <div\n      class=\"case-card relative flex flex-col border-2 rounded-xl shadow-md overflow-hidden \n             transition-all duration-300 cursor-pointer focus:ring-2 focus:ring-blue-500 outline-none \n             bg-gray-500 dark:bg-gray-800 hover:scale-[1.02] hover:shadow-lg\n             ${\n               caseData.urgency.toLowerCase() === \"critical\"\n                 ? \"border-red-500\"\n                 : \"\"\n             }\n             ${\n               caseData.urgency.toLowerCase() === \"high\"\n                 ? \"border-orange-500\"\n                 : \"\"\n             }\n             ${\n               caseData.urgency.toLowerCase() === \"moderate\"\n                 ? \"border-yellow-400\"\n                 : \"\"\n             }\n             ${\n               caseData.urgency.toLowerCase() === \"low\"\n                 ? \"border-green-500\"\n                 : \"\"\n             }\n             ${caseData.isNew ? \"ring-2 ring-blue-400 animate-pulse\" : \"\"}\n             \"\n      data-case-id=\"${caseData.id}\"\n      style=\"border-color: ${urgencyConfig.color};\"\n      role=\"listitem\"\n      tabindex=\"0\"\n      aria-label=\"${ariaLabel}\"\n    >\n\n      <!-- Header -->\n      <div class=\"bg-gray-900 text-white flex items-center justify-between px-4 py-2\">\n        <div class=\"flex items-center gap-2 font-semibold text-sm tracking-wide\">\n          ${urgencyConfig.icon} ${caseData.urgency}\n        </div>\n        <div class=\"text-xs flex items-center gap-3 opacity-90\">\n          <span class=\"font-mono ${caseData.cityCode ? \"text-sm font-bold tracking-wider\" : \"\"}\">${patientCode}</span>\n       <span class=\"px-2 py-0.5 text-[11px] font-semibold rounded-full uppercase tracking-wide ${getModuleBadgeClass(\n         caseData.moduleType\n       )}\">\n  ${caseData.moduleType}\n</span>\n\n        </div>\n      </div>\n\n      <!-- City Code Banner -->\n      ${caseData.cityCode ? `\n      <div class=\"flex flex-col items-center justify-center py-3 bg-gradient-to-r from-blue-800 to-blue-600 text-white\">\n        <span class=\"text-[10px] uppercase tracking-[0.2em] opacity-60\">Patient-Code</span>\n        <span class=\"text-2xl font-black tracking-wider leading-tight\">${caseData.cityCode}</span>\n      </div>\n      ` : \"\"}\n\n      <!-- Risk Section -->\n      <div class=\"flex items-center justify-center gap-6 py-4 bg-blue-200 dark:bg-gray-800\">\n        <div class=\"flex justify-center items-center\">\n          ${renderRiskRingSVG(ichPercent, \"ICH\")}\n        </div>\n        ${\n          lvoPercent !== null\n            ? `<div class=\"flex justify-center items-center\">${renderRiskRingSVG(\n                lvoPercent,\n                \"LVO\"\n              )}</div>`\n            : \"\"\n        }\n      </div>\n\n      <!-- ETA Section -->\n      <div class=\"flex flex-col items-center justify-center py-3 bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200\">\n        <div class=\"flex items-end gap-1 text-2xl font-bold ${\n          isGpsStale ? \"text-yellow-500\" : \"text-blue-600 dark:text-blue-400\"\n        }\">\n          <span>${formattedETA}</span>\n          <span class=\"text-sm font-medium\">\n            ${formattedETA === \"Arrived\" || formattedETA === \"?\" ? \"\" : \"min\"}\n          </span>\n        </div>\n        <div class=\"text-xs mt-1 flex items-center gap-2 text-gray-600 dark:text-gray-400\">\n          <span>${\n            typeof distance === \"number\" ? distance.toFixed(1) : distance\n          } km</span>\n          ${\n            isGpsStale\n              ? '<span class=\"text-yellow-600 dark:text-yellow-400 font-semibold\" role=\"alert\">âš ï¸ GPS stale</span>'\n              : \"\"\n          }\n        </div>\n      </div>\n\n      <!-- Footer -->\n      <div class=\"flex items-center justify-between text-xs px-4 py-2 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300\">\n        <span>${receivedAgo}</span>\n        <span class=\"text-blue-600 dark:text-blue-400 font-semibold hover:underline\">View Details â†’</span>\n      </div>\n    </div>\n  `;\n}\n\n/**\n * Render SVG risk ring (Tailwind)\n */\nfunction renderRiskRingSVG(percent, label) {\n  const color = getRiskColor(percent);\n  const circumference = Math.PI * 100;\n  const offset = circumference * (1 - percent / 100);\n  const riskClass =\n    percent > 70\n      ? \"text-red-500\"\n      : percent > 50\n        ? \"text-orange-500\"\n        : percent > 30\n          ? \"text-yellow-400\"\n          : \"text-green-500\";\n\n  return `\n    <div class=\"flex flex-col items-center\">\n      <svg class=\"w-20 h-20 ${riskClass}\" viewBox=\"0 0 120 120\">\n        <circle cx=\"60\" cy=\"60\" r=\"50\" fill=\"none\" stroke=\"rgba(255,255,255,0.15)\" stroke-width=\"8\"/>\n        <circle\n          cx=\"60\"\n          cy=\"60\"\n          r=\"50\"\n          fill=\"none\"\n          stroke=\"${color}\"\n          stroke-width=\"8\"\n          stroke-dasharray=\"${circumference}\"\n          stroke-dashoffset=\"${offset}\"\n          stroke-linecap=\"round\"\n          transform=\"rotate(-90 60 60)\"/>\n        <text x=\"60\" y=\"65\" text-anchor=\"middle\" class=\"font-bold text-lg fill-black dark:fill-white\">\n          ${percent}%\n        </text>\n      </svg>\n      <div class=\"text-xs mt-1 uppercase tracking-wide text-gray-600 dark:text-gray-300\">${label}</div>\n    </div>\n  `;\n}\n","/**\n * Comprehensive Error Handling Utilities\n * iGFAP Stroke Triage Assistant - Enterprise Error Management\n *\n * Provides robust error handling for production medical applications\n *\n * @author iGFAP Project Team\n * @contact Deepak Bos <bosdeepak@gmail.com>\n */\n\n/**\n * Error severity levels\n */\nexport const ERROR_SEVERITY = {\n  LOW: \"low\",\n  MEDIUM: \"medium\",\n  HIGH: \"high\",\n  CRITICAL: \"critical\"\n};\n\n/**\n * Error categories for medical applications\n */\nexport const ERROR_CATEGORIES = {\n  NETWORK: \"network\",\n  VALIDATION: \"validation\",\n  AUTHENTICATION: \"authentication\",\n  CALCULATION: \"calculation\",\n  STORAGE: \"storage\",\n  RENDERING: \"rendering\",\n  MEDICAL: \"medical\",\n  SECURITY: \"security\"\n};\n\n/**\n * Medical error codes\n */\nexport const MEDICAL_ERROR_CODES = {\n  INVALID_VITAL_SIGNS: \"MED001\",\n  CALCULATION_FAILED: \"MED002\",\n  DATA_INCOMPLETE: \"MED003\",\n  PREDICTION_UNAVAILABLE: \"MED004\",\n  SAFETY_THRESHOLD_EXCEEDED: \"MED005\"\n};\n\n/**\n * Enhanced error class for medical applications\n */\nexport class MedicalError extends Error {\n  constructor(\n    message,\n    code,\n    category = ERROR_CATEGORIES.MEDICAL,\n    severity = ERROR_SEVERITY.MEDIUM\n  ) {\n    super(message);\n    this.name = \"MedicalError\";\n    this.code = code;\n    this.category = category;\n    this.severity = severity;\n    this.timestamp = new Date().toISOString();\n    this.context = {};\n  }\n\n  /**\n   * Add context to error\n   * @param {Object} context - Error context\n   * @returns {MedicalError} - This error instance\n   */\n  withContext(context) {\n    this.context = { ...this.context, ...context };\n    return this;\n  }\n\n  /**\n   * Get user-friendly error message\n   * @returns {string} - User-friendly message\n   */\n  getUserMessage() {\n    switch (this.category) {\n      case ERROR_CATEGORIES.NETWORK:\n        return \"Network connection issue. Please check your internet connection and try again.\";\n      case ERROR_CATEGORIES.VALIDATION:\n        return \"Please check your input data and try again.\";\n      case ERROR_CATEGORIES.AUTHENTICATION:\n        return \"Authentication failed. Please log in again.\";\n      case ERROR_CATEGORIES.CALCULATION:\n        return \"Unable to complete calculation. Please verify your input data.\";\n      case ERROR_CATEGORIES.MEDICAL:\n        return \"Medical calculation could not be completed. Please verify all clinical data.\";\n      default:\n        return \"An unexpected error occurred. Please try again.\";\n    }\n  }\n}\n\n/**\n * Global error handler for unhandled errors\n */\nclass GlobalErrorHandler {\n  constructor() {\n    this.errorQueue = [];\n    this.maxQueueSize = 100;\n    this.setupGlobalHandlers();\n  }\n\n  setupGlobalHandlers() {\n    // Handle unhandled promise rejections\n    window.addEventListener(\"unhandledrejection\", (event) => {\n      this.handleError(\n        event.reason,\n        ERROR_CATEGORIES.NETWORK,\n        ERROR_SEVERITY.HIGH\n      );\n      event.preventDefault();\n    });\n\n    // Handle uncaught errors\n    window.addEventListener(\"error\", (event) => {\n      this.handleError(\n        event.error,\n        ERROR_CATEGORIES.RENDERING,\n        ERROR_SEVERITY.MEDIUM\n      );\n    });\n  }\n\n  handleError(\n    error,\n    category = ERROR_CATEGORIES.NETWORK,\n    severity = ERROR_SEVERITY.MEDIUM\n  ) {\n    const errorEntry = {\n      error: error instanceof Error ? error : new Error(String(error)),\n      category,\n      severity,\n      timestamp: new Date().toISOString(),\n      userAgent: navigator.userAgent.substring(0, 100),\n      url: window.location.href\n    };\n\n    // Add to queue\n    this.errorQueue.push(errorEntry);\n    if (this.errorQueue.length > this.maxQueueSize) {\n      this.errorQueue.shift();\n    }\n\n    // Handle critical errors immediately\n    if (severity === ERROR_SEVERITY.CRITICAL) {\n      this.handleCriticalError(errorEntry);\n    }\n  }\n\n  handleCriticalError(errorEntry) {\n    // For critical medical errors, show immediate user notification\n    if (errorEntry.category === ERROR_CATEGORIES.MEDICAL) {\n      this.showMedicalAlert(errorEntry.error.message);\n    }\n  }\n\n  showMedicalAlert(message) {\n    // Create a critical medical alert\n    const alert = document.createElement(\"div\");\n    alert.className = \"critical-medical-alert\";\n    alert.style.cssText = `\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: #ff4444;\n      color: white;\n      padding: 15px 20px;\n      border-radius: 8px;\n      z-index: 10000;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      max-width: 90%;\n      text-align: center;\n    `;\n    alert.textContent = `âš ï¸ Medical Error: ${message}`;\n\n    document.body.appendChild(alert);\n\n    // Auto-remove after 10 seconds\n    setTimeout(() => {\n      if (document.body.contains(alert)) {\n        document.body.removeChild(alert);\n      }\n    }, 10000);\n  }\n\n  getErrorSummary() {\n    return {\n      totalErrors: this.errorQueue.length,\n      criticalErrors: this.errorQueue.filter(\n        (e) => e.severity === ERROR_SEVERITY.CRITICAL\n      ).length,\n      recentErrors: this.errorQueue.slice(-10)\n    };\n  }\n}\n\n// Initialize global error handler\nconst globalErrorHandler = new GlobalErrorHandler();\n\n/**\n * Wrapper for async operations with comprehensive error handling\n * @param {Function} asyncFn - Async function to execute\n * @param {Object} options - Error handling options\n * @returns {Promise} - Promise with error handling\n */\nexport async function safeAsync(asyncFn, options = {}) {\n  const {\n    category = ERROR_CATEGORIES.NETWORK,\n    severity = ERROR_SEVERITY.MEDIUM,\n    fallback = null,\n    timeout = 30000,\n    retries = 0,\n    context = {}\n  } = options;\n\n  let lastError;\n\n  for (let attempt = 0; attempt <= retries; attempt++) {\n    try {\n      // Add timeout wrapper\n      const timeoutPromise = new Promise((_, reject) => {\n        setTimeout(() => reject(new Error(\"Operation timeout\")), timeout);\n      });\n\n      const result = await Promise.race([asyncFn(), timeoutPromise]);\n      return result;\n    } catch (error) {\n      lastError = error;\n\n      // Log error\n      globalErrorHandler.handleError(error, category, severity);\n\n      // If we have retries left, wait and retry\n      if (attempt < retries) {\n        await new Promise((resolve) =>\n          setTimeout(resolve, 1000 * (attempt + 1))\n        );\n        continue;\n      }\n\n      // Final attempt failed\n      if (fallback !== null) {\n        return typeof fallback === \"function\" ? fallback(error) : fallback;\n      }\n\n      // Throw enhanced error\n      const enhancedError = new MedicalError(\n        error.message || \"Operation failed\",\n        error.code || \"UNKNOWN\",\n        category,\n        severity\n      ).withContext(context);\n\n      throw enhancedError;\n    }\n  }\n}\n\n/**\n * Safe wrapper for medical calculations\n * @param {Function} calculationFn - Medical calculation function\n * @param {Object} inputs - Input data\n * @param {Object} options - Calculation options\n * @returns {Promise} - Calculation result with error handling\n */\nexport async function safeMedicalCalculation(\n  calculationFn,\n  inputs,\n  options = {}\n) {\n  return safeAsync(() => calculationFn(inputs), {\n    category: ERROR_CATEGORIES.MEDICAL,\n    severity: ERROR_SEVERITY.HIGH,\n    fallback: () => ({\n      error: true,\n      message: \"Medical calculation unavailable\",\n      fallbackUsed: true\n    }),\n    context: {\n      operation: \"medical_calculation\",\n      inputKeys: Object.keys(inputs || {}),\n      ...options.context\n    },\n    ...options\n  });\n}\n\n/**\n * Safe wrapper for network requests\n * @param {Function} requestFn - Network request function\n * @param {Object} options - Request options\n * @returns {Promise} - Request result with error handling\n */\nexport async function safeNetworkRequest(requestFn, options = {}) {\n  return safeAsync(requestFn, {\n    category: ERROR_CATEGORIES.NETWORK,\n    severity: ERROR_SEVERITY.MEDIUM,\n    retries: 2,\n    timeout: 10000,\n    fallback: () => ({\n      error: true,\n      message: \"Network request failed\",\n      offline: true\n    }),\n    ...options\n  });\n}\n\n/**\n * Safe wrapper for authentication operations\n * @param {Function} authFn - Authentication function\n * @param {Object} options - Auth options\n * @returns {Promise} - Auth result with error handling\n */\nexport async function safeAuthOperation(authFn, options = {}) {\n  return safeAsync(authFn, {\n    category: ERROR_CATEGORIES.AUTHENTICATION,\n    severity: ERROR_SEVERITY.HIGH,\n    timeout: 15000,\n    fallback: () => ({\n      success: false,\n      error: true,\n      message: \"Authentication service unavailable\"\n    }),\n    ...options\n  });\n}\n\n/**\n * Create error boundary for React-like error handling\n * @param {HTMLElement} element - DOM element to wrap\n * @param {Function} renderFn - Function to render content\n * @param {Function} errorFn - Function to render error state\n */\nexport function createErrorBoundary(element, renderFn, errorFn) {\n  try {\n    renderFn();\n  } catch (error) {\n    globalErrorHandler.handleError(\n      error,\n      ERROR_CATEGORIES.RENDERING,\n      ERROR_SEVERITY.MEDIUM\n    );\n\n    if (errorFn) {\n      errorFn(error);\n    } else {\n      element.textContent = \"Content could not be displayed due to an error.\";\n    }\n  }\n}\n\n/**\n * Validate medical input data\n * @param {Object} data - Input data\n * @param {Object} schema - Validation schema\n * @returns {Object} - Validation result\n */\nexport function validateMedicalInputs(data, schema) {\n  const errors = [];\n  const warnings = [];\n\n  Object.keys(schema).forEach((key) => {\n    const rule = schema[key];\n    const value = data[key];\n\n    // Required field check\n    if (\n      rule.required &&\n      (value === undefined || value === null || value === \"\")\n    ) {\n      errors.push({\n        field: key,\n        code: MEDICAL_ERROR_CODES.DATA_INCOMPLETE,\n        message: `${key} is required`\n      });\n      return;\n    }\n\n    // Type check\n    if (value !== undefined && rule.type) {\n      const expectedType = rule.type;\n      const actualType = typeof value;\n\n      if (\n        expectedType === \"number\" &&\n        (isNaN(value) || actualType !== \"number\")\n      ) {\n        errors.push({\n          field: key,\n          code: MEDICAL_ERROR_CODES.INVALID_VITAL_SIGNS,\n          message: `${key} must be a valid number`\n        });\n        return;\n      }\n    }\n\n    // Range check for medical values\n    if (value !== undefined && typeof value === \"number\") {\n      if (rule.min !== undefined && value < rule.min) {\n        errors.push({\n          field: key,\n          code: MEDICAL_ERROR_CODES.INVALID_VITAL_SIGNS,\n          message: `${key} must be at least ${rule.min}`\n        });\n      }\n\n      if (rule.max !== undefined && value > rule.max) {\n        errors.push({\n          field: key,\n          code: MEDICAL_ERROR_CODES.INVALID_VITAL_SIGNS,\n          message: `${key} must not exceed ${rule.max}`\n        });\n      }\n\n      // Medical warning thresholds\n      if (rule.warningMin !== undefined && value < rule.warningMin) {\n        warnings.push({\n          field: key,\n          message: `${key} is below typical range (${rule.warningMin})`\n        });\n      }\n\n      if (rule.warningMax !== undefined && value > rule.warningMax) {\n        warnings.push({\n          field: key,\n          message: `${key} is above typical range (${rule.warningMax})`\n        });\n      }\n    }\n  });\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n    hasWarnings: warnings.length > 0\n  };\n}\n\n/**\n * Get error handler instance for debugging\n */\nexport function getErrorHandler() {\n  return globalErrorHandler;\n}\n\n/**\n * Export error classes\n */\nexport { GlobalErrorHandler };\n","/**\n * Kiosk Main Application\n * Entry point for Notaufnahme kiosk display\n * Supports end-to-end encryption for patient data protection\n */\nimport \"./index.css\";\nimport { i18n, t } from \"../localization/i18n.js\";\nimport { KIOSK_CONFIG, ENCRYPTION_CONFIG } from \"./config.js\";\nimport { caseListener } from \"./services/case-listener.js\";\nimport { renderDashboard } from \"./ui/dashboard.js\";\nimport { CONSTANTS } from \"./utils.js\";\nimport { safeAsync, ERROR_CATEGORIES } from \"./utils/error-handler.js\";\nimport { cryptoService } from \"./services/crypto-service.js\";\n\n// Application state\nlet currentCases = [];\nlet audioContext = null;\nlet clockIntervalId = null;\nlet isFirstLoad = true;\n\n/**\n * Initialize kiosk application\n */\nasync function initializeKiosk() {\n  console.log(\"[Kiosk] Initializing...\", KIOSK_CONFIG);\n\n  // Initialize end-to-end encryption for patient data protection\n  if (ENCRYPTION_CONFIG.enabled && ENCRYPTION_CONFIG.encryptionKey) {\n    try {\n      await cryptoService.init(ENCRYPTION_CONFIG.encryptionKey);\n      console.log(\"[Kiosk] End-to-end encryption initialized\");\n    } catch (error) {\n      console.warn(\"[Kiosk] Encryption initialization failed:\", error.message);\n      // Continue without encryption - graceful degradation\n    }\n  } else {\n    console.log(\"[Kiosk] Encryption disabled or no key configured\");\n  }\n\n  // Initialize hospital selector\n  initializeHospitalSelector();\n\n  // Initialize theme\n  initializeTheme();\n\n  // Start clock\n  updateClock();\n  clockIntervalId = setInterval(updateClock, 1000);\n\n  // Initialize audio if enabled\n  if (KIOSK_CONFIG.playAudioAlert) {\n    initializeAudio();\n  }\n\n  // Start case listener\n  caseListener.start(\n    (data) => handleCaseUpdate(data),\n    (error) => handleError(error)\n  );\n\n  // Add event listeners\n  attachEventListeners();\n\n  // Add cleanup on page unload\n  window.addEventListener(\"beforeunload\", cleanup);\n\n  console.log(\"[Kiosk] Initialized successfully\");\n\n  initializeLanguage();\n}\nfunction initializeLanguage() {\n  setTimeout(() => {\n    const savedLang = localStorage.getItem(\"language\") || \"en\";\n    const languageToggle = document.getElementById(\"languageToggle\");\n    if (!languageToggle) return;\n\n    languageToggle.innerHTML =\n      savedLang === \"en\" ? renderUKFlag() : renderGermanyFlag();\n    languageToggle.addEventListener(\"click\", toggleLanguage);\n    console.log(\"[Kiosk] Language toggle ready\");\n  }, 200);\n}\n\nfunction toggleLanguage() {\n  safeAsync(\n    async () => {\n      i18n.toggleLanguage();\n      updateLanguage();\n    },\n    (error) => console.warn(\"[Kiosk] Language toggle failed\", error),\n    {\n      category: ERROR_CATEGORIES.RENDERING,\n      context: { operation: \"language_toggle\" }\n    }\n  );\n}\n\nfunction updateButtonAttributes(id, label) {\n  const btn = document.getElementById(id);\n  if (btn) {\n    btn.title = label;\n    btn.setAttribute(\"aria-label\", label);\n  }\n}\n\nfunction updateLanguage() {\n  document.documentElement.lang = i18n.getCurrentLanguage();\n  updateElementText(\".app-header h1\", t(\"appTitle\"));\n  updateElementText(\".emergency-badge\", t(\"emergencyBadge\"));\n  updateButtonAttributes(\"languageToggle\", t(\"languageToggle\"));\n  updateButtonAttributes(\"helpButton\", t(\"helpButton\"));\n  updateButtonAttributes(\"darkModeToggle\", t(\"darkModeButton\"));\n  updateElementText(\"#modalTitle\", t(\"helpTitle\"));\n\n  if (i18n.updateUI) i18n.updateUI(); // optional auto-refresh\n\n  const languageToggle = document.getElementById(\"languageToggle\");\n  if (languageToggle) {\n    const currentLang = i18n.getCurrentLanguage();\n    languageToggle.innerHTML =\n      currentLang === \"en\" ? renderUKFlag() : renderGermanyFlag();\n  }\n}\n\nfunction renderUKFlag() {\n  return ` <svg\n              width=\"20px\"\n              height=\"20px\"\n              viewBox=\"0 0 36 36\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n              aria-hidden=\"true\"\n              role=\"img\"\n              class=\"iconify iconify--twemoji\"\n              preserveAspectRatio=\"xMidYMid meet\"\n            >\n              <path fill=\"#FFCD05\" d=\"M0 27a4 4 0 0 0 4 4h28a4 4 0 0 0 4-4v-4H0v4z\"></path>\n              <path fill=\"#ED1F24\" d=\"M0 14h36v9H0z\"></path>\n              <path fill=\"#141414\" d=\"M32 5H4a4 4 0 0 0-4 4v5h36V9a4 4 0 0 0-4-4z\"></path>\n            </svg>`; // your flag SVG\n}\n\nfunction renderGermanyFlag() {\n  return `<svg width=\\\"20px\\\" height=\\\"20px\\\" viewBox=\\\"0 0 36 36\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" aria-hidden=\\\"true\\\" role=\\\"img\\\" class=\\\"iconify iconify--twemoji\\\" preserveAspectRatio=\\\"xMidYMid meet\\\"><path fill=\\\"#00247D\\\" d=\\\"M0 9.059V13h5.628zM4.664 31H13v-5.837zM23 25.164V31h8.335zM0 23v3.941L5.63 23zM31.337 5H23v5.837zM36 26.942V23h-5.631zM36 13V9.059L30.371 13zM13 5H4.664L13 10.837z\\\"></path><path fill=\\\"#CF1B2B\\\" d=\\\"M25.14 23l9.712 6.801a3.977 3.977 0 0 0 .99-1.749L28.627 23H25.14zM13 23h-2.141l-9.711 6.8c.521.53 1.189.909 1.938 1.085L13 23.943V23zm10-10h2.141l9.711-6.8a3.988 3.988 0 0 0-1.937-1.085L23 12.057V13zm-12.141 0L1.148 6.2a3.994 3.994 0 0 0-.991 1.749L7.372 13h3.487z\\\"></path><path fill=\\\"#EEE\\\" d=\\\"M36 21H21v10h2v-5.836L31.335 31H32a3.99 3.99 0 0 0 2.852-1.199L25.14 23h3.487l7.215 5.052c.093-.337.158-.686.158-1.052v-.058L30.369 23H36v-2zM0 21v2h5.63L0 26.941V27c0 1.091.439 2.078 1.148 2.8l9.711-6.8H13v.943l-9.914 6.941c.294.07.598.116.914.116h.664L13 25.163V31h2V21H0zM36 9a3.983 3.983 0 0 0-1.148-2.8L25.141 13H23v-.943l9.915-6.942A4.001 4.001 0 0 0 32 5h-.663L23 10.837V5h-2v10h15v-2h-5.629L36 9.059V9zM13 5v5.837L4.664 5H4a3.985 3.985 0 0 0-2.852 1.2l9.711 6.8H7.372L.157 7.949A3.968 3.968 0 0 0 0 9v.059L5.628 13H0v2h15V5h-2z\\\"></path><path fill=\\\"#CF1B2B\\\" d=\\\"M21 15V5h-6v10H0v6h15v10h6V21h15v-6z\\\"></path></svg>`;\n}\n\nfunction updateElementText(selector, text) {\n  const el = document.querySelector(selector);\n  if (el) el.textContent = text;\n}\n\n/**\n * Cleanup resources before page unload\n */\nfunction cleanup() {\n  console.log(\"[Kiosk] Cleaning up resources...\");\n\n  // Stop polling\n  caseListener.stop();\n\n  // Clear clock interval\n  if (clockIntervalId) {\n    clearInterval(clockIntervalId);\n    clockIntervalId = null;\n  }\n\n  // Close audio context\n  if (audioContext && audioContext.state !== \"closed\") {\n    audioContext.close().catch((err) => {\n      console.warn(\"[Kiosk] Error closing audio context:\", err);\n    });\n  }\n}\n\n/**\n * Handle case updates\n */\nfunction handleCaseUpdate(data) {\n  const previousCount = currentCases.length;\n  currentCases = data.cases || [];\n\n  console.log(\"[Kiosk] Cases updated:\", {\n    count: currentCases.length,\n    previous: previousCount\n  });\n\n  // Update UI\n  renderDashboard(currentCases);\n  updateHeader(data);\n\n  // Check for new cases (skip alert on first load)\n  const newCases = currentCases.filter((c) => c.isNew);\n  if (newCases.length > 0 && !isFirstLoad) {\n    // Show alert for new cases\n    playNewCaseAlert();\n    flashScreen();\n\n    // Mark as viewed after showing alert\n    setTimeout(() => {\n      newCases.forEach((c) => caseListener.markViewed(c.id));\n    }, CONSTANTS.NEW_CASE_VIEWED_DELAY_MS);\n  }\n\n  // Mark first load complete\n  if (isFirstLoad) {\n    isFirstLoad = false;\n  }\n\n  // Update connection status\n  updateConnectionStatus(true);\n}\n\n/**\n * Handle errors\n */\nfunction handleError(error) {\n  console.error(\"[Kiosk] Error:\", error);\n  updateConnectionStatus(false);\n\n  // Show error in UI if no cases\n  if (currentCases.length === 0) {\n    const container = document.getElementById(\"casesContainer\");\n    if (container) {\n      container.innerHTML = `\n        <div class=\"error-state\">\n          <div class=\"error-icon\">âš ï¸</div>\n          <h2>Verbindungsfehler / Connection Error</h2>\n          <p>${\n            error.message || \"Unable to connect to case monitoring system\"\n          }</p>\n          <p class=\"error-hint\">Checking again in ${\n            KIOSK_CONFIG.pollInterval / 1000\n          } seconds...</p>\n        </div>\n      `;\n    }\n  }\n}\n\n/**\n * Initialize hospital selector\n */\nfunction initializeHospitalSelector() {\n  // Import available hospitals and setHospital function\n  const selector = document.getElementById(\"hospitalSelector\");\n  if (!selector) return;\n\n  // Dynamically import hospitals list\n  import(\"./config.js\").then(({ AVAILABLE_HOSPITALS, setHospital }) => {\n    const currentHospitalId = KIOSK_CONFIG.hospitalId || \"ALL\";\n\n    // ðŸ”’ Ensure ALL is always present and first\n    const hospitals = [\n      { id: \"ALL\", name: \"ðŸŒ All Hospitals (Show All Cases)\" },\n      ...AVAILABLE_HOSPITALS.filter((h) => h.id !== \"ALL\")\n    ];\n\n    selector.innerHTML = hospitals\n      .map(\n        (h) => `\n      <option value=\"${h.id}\">\n        ${h.name}\n      </option>\n    `\n      )\n      .join(\"\");\n\n    // âœ… This will now ALWAYS work\n    selector.value = currentHospitalId;\n\n    // ðŸ” Safety fallback\n    if (!selector.value) {\n      selector.value = \"ALL\";\n    }\n\n    selector.addEventListener(\"change\", (e) => {\n      const hospitalId = e.target.value;\n      if (\n        confirm(\n          `Switch to ${\n            e.target.options[e.target.selectedIndex].text\n          }?\\n\\nThis will reload the page.`\n        )\n      ) {\n        setHospital(hospitalId);\n      } else {\n        selector.value = currentHospitalId;\n      }\n    });\n  });\n}\n\n/**\n * Initialize theme\n */\nfunction initializeTheme() {\n  // Get saved theme or use default from config\n  const savedTheme = localStorage.getItem(\"kiosk_theme\") || KIOSK_CONFIG.theme;\n  applyTheme(savedTheme);\n\n  // Add theme toggle button listener\n  const themeToggle = document.getElementById(\"themeToggle\");\n  if (themeToggle) {\n    themeToggle.addEventListener(\"click\", toggleTheme);\n  }\n\n  console.log(\"[Kiosk] Theme initialized:\", savedTheme);\n}\n\n/**\n * Toggle between light and dark theme\n */\nfunction toggleTheme() {\n  const html = document.documentElement;\n  const isDark = html.classList.toggle(\"dark\"); // Tailwind looks for this\n  const newTheme = isDark ? \"dark\" : \"light\";\n\n  localStorage.setItem(\"kiosk_theme\", newTheme);\n  applyTheme(newTheme);\n\n  console.log(\"[Kiosk] Theme switched to:\", newTheme);\n}\n\nfunction applyTheme(theme) {\n  const html = document.documentElement;\n  if (theme === \"dark\") {\n    html.classList.add(\"dark\");\n  } else {\n    html.classList.remove(\"dark\");\n  }\n\n  const themeIcon = document.querySelector(\".theme-icon\");\n  if (themeIcon) {\n    themeIcon.textContent = theme === \"dark\" ? \"â˜€ï¸\" : \"ðŸŒ™\";\n  }\n}\n\n/**\n * Update header information\n */\nfunction updateHeader(data) {\n  // Update case count\n  const countBadge = document.getElementById(\"caseCount\");\n  if (countBadge) {\n    const count = data.count || 0;\n    countBadge.textContent = `${count} ${count === 1 ? \"Case\" : \"Cases\"}`;\n    countBadge.className = `case-count-badge ${count > 0 ? \"has-cases\" : \"\"}`;\n  }\n}\n\n/**\n * Update connection status indicator\n */\nfunction updateConnectionStatus(connected) {\n  const status = document.getElementById(\"connectionStatus\");\n  if (status) {\n    status.className = `status-indicator ${\n      connected ? \"connected\" : \"disconnected\"\n    }`;\n    status.title = connected ? \"Connected\" : \"Disconnected\";\n    status.setAttribute(\n      \"aria-label\",\n      `Connection status: ${connected ? \"connected\" : \"disconnected\"}`\n    );\n  }\n}\n\n/**\n * Update clock\n */\nfunction updateClock() {\n  const clockElement = document.getElementById(\"currentTime\");\n  if (clockElement) {\n    const now = new Date();\n    clockElement.textContent = now.toLocaleTimeString(\"de-DE\", {\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      second: \"2-digit\"\n    });\n  }\n}\n\n/**\n * Initialize audio context\n */\nfunction initializeAudio() {\n  // Create audio context on first user interaction\n  document.addEventListener(\n    \"click\",\n    () => {\n      if (!audioContext) {\n        audioContext = new (window.AudioContext || window.webkitAudioContext)();\n        console.log(\"[Kiosk] Audio initialized\");\n      }\n    },\n    { once: true }\n  );\n}\n\n/**\n * Play new case alert with audio context resume\n */\nasync function playNewCaseAlert() {\n  if (!KIOSK_CONFIG.playAudioAlert || !audioContext) {\n    return;\n  }\n\n  try {\n    // Resume audio context if suspended (browser throttling)\n    if (audioContext.state === \"suspended\") {\n      await audioContext.resume();\n      console.log(\"[Kiosk] Audio context resumed\");\n    }\n\n    // Generate alert beep\n    const oscillator = audioContext.createOscillator();\n    const gainNode = audioContext.createGain();\n\n    oscillator.connect(gainNode);\n    gainNode.connect(audioContext.destination);\n\n    oscillator.frequency.value = CONSTANTS.ALERT_BEEP_FREQUENCY_HZ;\n    oscillator.type = \"sine\";\n\n    gainNode.gain.setValueAtTime(\n      CONSTANTS.ALERT_BEEP_VOLUME,\n      audioContext.currentTime\n    );\n    gainNode.gain.exponentialRampToValueAtTime(\n      0.01,\n      audioContext.currentTime + CONSTANTS.ALERT_BEEP_DURATION_SEC\n    );\n\n    oscillator.start(audioContext.currentTime);\n    oscillator.stop(\n      audioContext.currentTime + CONSTANTS.ALERT_BEEP_DURATION_SEC\n    );\n\n    console.log(\"[Kiosk] Alert sound played\");\n  } catch (error) {\n    console.warn(\"[Kiosk] Audio playback failed:\", error);\n  }\n}\n\n/**\n * Flash screen for new case\n */\nfunction flashScreen() {\n  document.body.classList.add(\"flash-alert\");\n\n  setTimeout(() => {\n    document.body.classList.remove(\"flash-alert\");\n  }, 1000);\n}\n\n/**\n * Attach event listeners\n */\nfunction attachEventListeners() {\n  // Click on case card to navigate to PWA results page\n  document.addEventListener(\"click\", (e) => {\n    const caseCard = e.target.closest(\".case-card\");\n    if (caseCard) {\n      const caseId = caseCard.dataset.caseId;\n      if (caseId) {\n        // Navigate to PWA results page in kiosk mode\n        const pwaUrl = `${KIOSK_CONFIG.pwaUrl}#results?display=kiosk&caseId=${caseId}`;\n        window.location.href = pwaUrl;\n        caseListener.markViewed(caseId);\n      }\n    }\n\n    // Dismiss case button\n    const dismissButton = e.target.closest(\".dismiss-case-button\");\n    if (dismissButton) {\n      const caseId = dismissButton.dataset.caseId;\n      if (caseId) {\n        handleDismissCase(caseId);\n      }\n    }\n\n    // Close modal\n    if (\n      e.target.classList.contains(\"modal-overlay\") ||\n      e.target.classList.contains(\"close-modal\")\n    ) {\n      closeModal();\n    }\n  });\n\n  // Keyboard navigation\n  document.addEventListener(\"keydown\", (e) => {\n    // ESC key to close modal\n    if (e.key === \"Escape\") {\n      closeModal();\n      return;\n    }\n\n    // Enter or Space on case card to navigate to PWA results\n    if (e.key === \"Enter\" || e.key === \" \") {\n      const caseCard = e.target.closest(\".case-card\");\n      if (caseCard) {\n        e.preventDefault(); // Prevent scroll on Space\n        const caseId = caseCard.dataset.caseId;\n        if (caseId) {\n          // Navigate to PWA results page in kiosk mode\n          const pwaUrl = `https://igfap.eu/0825/#results?display=kiosk&caseId=${caseId}`;\n          window.location.href = pwaUrl;\n          caseListener.markViewed(caseId);\n        }\n      }\n    }\n  });\n\n  // Visibility change - resume polling if tab becomes visible\n  document.addEventListener(\"visibilitychange\", () => {\n    if (document.visibilityState === \"visible\") {\n      console.log(\"[Kiosk] Tab visible - fetching latest cases\");\n      caseListener.fetchCases();\n    }\n  });\n\n  // Listen for custom dismissCase event from case detail modal\n  window.addEventListener(\"dismissCase\", (e) => {\n    const caseId = e.detail?.caseId;\n    if (caseId) {\n      console.log(\"[Kiosk] Received dismissCase event for:\", caseId);\n      handleDismissCase(caseId);\n    } else {\n      console.error(\"[Kiosk] dismissCase event missing caseId\");\n    }\n  });\n}\n\n/**\n * Handle case dismissal with confirmation\n */\nasync function handleDismissCase(caseId) {\n  const caseData = caseListener.getCase(caseId);\n  if (!caseData) {\n    console.warn(\"[Kiosk] Case not found:\", caseId);\n    return;\n  }\n\n  // Show confirmation dialog\n  const confirmMessage =\n    `Are you sure you want to dismiss this case?\\n\\n` +\n    `Ambulance: ${caseData.ambulanceId}\\n` +\n    `Module: ${caseData.moduleType}\\n` +\n    `ICH Risk: ${Math.round(\n      (caseData.results?.ich?.probability || 0) * 100\n    )}%\\n\\n` +\n    `This action will archive the case.`;\n\n  const confirmed = confirm(confirmMessage);\n\n  if (!confirmed) {\n    console.log(\"[Kiosk] Case dismissal cancelled\");\n    return;\n  }\n\n  try {\n    // Disable button to prevent double-click\n    const dismissButton = document.querySelector(`[data-case-id=\"${caseId}\"]`);\n    if (dismissButton) {\n      dismissButton.disabled = true;\n      dismissButton.textContent = \"Dismissing...\";\n    }\n\n    // Call API to dismiss case\n    await caseListener.dismissCase(caseId);\n\n    console.log(\"[Kiosk] Case dismissed successfully:\", caseId);\n\n    // Close modal\n    closeModal();\n\n    // Show success feedback (optional flash)\n    document.body.classList.add(\"flash-success\");\n    setTimeout(() => {\n      document.body.classList.remove(\"flash-success\");\n    }, 500);\n  } catch (error) {\n    console.error(\"[Kiosk] Failed to dismiss case:\", error);\n\n    // Show error alert\n    alert(\n      `Failed to dismiss case:\\n${error.message}\\n\\nPlease try again or contact support.`\n    );\n\n    // Re-enable button\n    const dismissButton = document.querySelector(`[data-case-id=\"${caseId}\"]`);\n    if (dismissButton) {\n      dismissButton.disabled = false;\n      dismissButton.textContent = \"ðŸ—‘ï¸ Dismiss Case\";\n    }\n  }\n}\n\n/**\n * Close case detail modal\n */\nfunction closeModal() {\n  const modal = document.getElementById(\"caseDetailModal\");\n  if (modal) {\n    modal.style.display = \"none\";\n    modal.querySelector(\".modal-content\").innerHTML = \"\";\n  }\n}\n\n/**\n * Handle application errors\n */\nwindow.addEventListener(\"error\", (event) => {\n  console.error(\"[Kiosk] Unhandled error:\", event.error);\n});\n\nwindow.addEventListener(\"unhandledrejection\", (event) => {\n  console.error(\"[Kiosk] Unhandled rejection:\", event.reason);\n});\n\n/**\n * Start application when DOM ready\n */\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", initializeKiosk);\n} else {\n  initializeKiosk();\n}\n\n/**\n * Export for debugging\n */\nwindow.kioskApp = {\n  getCases: () => currentCases,\n  getStatus: () => caseListener.getStatus(),\n  refresh: () => caseListener.fetchCases(),\n  playAlert: () => playNewCaseAlert()\n};\n"],"file":"assets/index-0b0b5pIS.js"}